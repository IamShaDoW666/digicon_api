(()=>{var e={};e.id=113,e.ids=[113],e.modules={3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},9004:(e,r,t)=>{"use strict";t.d(r,{BatchCard:()=>a});let a=(0,t(66057).registerClientReference)(function(){throw Error("Attempted to call BatchCard() from the server but BatchCard is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"C:\\xampp\\htdocs\\digicon_api\\src\\app\\admin\\batches\\[id]\\batchCard.tsx","BatchCard")},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},19121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},19384:(e,r,t)=>{"use strict";t.d(r,{BatchCard:()=>x});var a=t(56877),s=t(41693),i=t(88115),n=t(59363),d=t(36741),c=t(20617),o=t(53571),l=t(74412),u=t(99798),m=t(19886);let p=(0,m.createServerReference)("7fcbe02165971ead0d61c5c2b179654ffe053245b0",m.callServer,void 0,m.findSourceMapURL,"updateBatch");var h=t(30711);let f=o.z.object({reference:o.z.string().min(1,"Reference is required"),id:o.z.string().min(1,"ID is required")});function x({reference:e,id:r}){let t=(0,h.useRouter)(),o=(0,c.mN)({resolver:(0,l.u)(f),defaultValues:{reference:e.slice(7),id:r}}),m=async e=>{try{let r=await p(e);r.success?(u.oR.success("Batch updated successfully \uD83C\uDF89"),t.back(),setTimeout(()=>{t.refresh()},100)):u.oR.error(r.message||"Failed to update batch")}catch(e){console.error("Error updating batch:",e),u.oR.error("Failed to update batch")}};return(0,a.jsxs)(s.Zp,{className:"w-full max-w-md",children:[(0,a.jsx)(s.aR,{children:(0,a.jsx)(s.ZB,{children:"Batch Details"})}),(0,a.jsx)(s.Wu,{children:(0,a.jsx)(d.lV,{...o,children:(0,a.jsxs)("form",{onSubmit:o.handleSubmit(m),className:"space-y-4",children:[(0,a.jsx)(d.zB,{control:o.control,name:"reference",render:({field:e})=>(0,a.jsxs)(d.eI,{children:[(0,a.jsx)(d.lR,{children:"Reference"}),(0,a.jsx)(d.MJ,{children:(0,a.jsx)(i.p,{placeholder:"Enter batch reference",...e})}),(0,a.jsx)(d.C5,{})]})}),(0,a.jsx)(s.wL,{className:"p-0",children:(0,a.jsx)(n.$,{type:"submit",children:"Update"})})]})})})]})}},23365:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>d});var a=t(65095),s=t(55029),i=t(37321),n=t(9004);let d=async({params:e})=>{let r=await i.z.batch.findFirst({where:{id:(await e).id},include:{media:!0,createdBy:!0}});return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(s.D,{title:r?.reference}),(0,a.jsx)("div",{className:"flex flex-1 flex-col mx-6",children:(0,a.jsx)("div",{className:"@container/main flex flex-1 flex-col gap-2",children:(0,a.jsxs)("div",{className:"flex flex-col gap-4 py-4 md:gap-6 md:py-6",children:[(0,a.jsx)(n.BatchCard,{reference:r?.reference,id:r?.id}),r?.media.length>0&&(0,a.jsx)("h2",{className:"font-semibold",children:"Media"}),r?.media.length>0&&(0,a.jsx)("div",{className:"grid grid-cols-4 gap-8",children:r?.media.map(e=>(0,a.jsx)("div",{className:"flex flex-col gap-2 rounded-md p-2 shadow-sm hover:shadow-md transition-all duration-200 hover:scale-105 ",children:(0,a.jsx)("a",{href:e.url,target:"_blank",rel:"noopener noreferrer",className:"text-blue-500 hover:underline",children:(0,a.jsx)("img",{src:e.url,alt:e.title??e.id,width:500,height:500})})},e.id))})]})})})]})}},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},29975:(e,r,t)=>{"use strict";t.r(r),t.d(r,{"000f403c10f162bfc016cc7644249d0cc89ec310df":()=>a.Z,"4048c479a59c87d3a98ee0148dec46b338540b1a0d":()=>a.i,"7fae3cdaf7e4a58385ded3bdbc4784b5095114875b":()=>u,"7fcbe02165971ead0d61c5c2b179654ffe053245b0":()=>m});var a=t(40575),s=t(37461);t(58337);var i=t(10126),n=t(33873),d=t.n(n),c=t(79748),o=t.n(c),l=t(89);let u=async e=>{let r=await i.z.batch.findFirst({where:{id:e},include:{media:!0}});if(!r)return{success:!1,message:"Batch not found"};let t=r.media.map(async e=>{let r=d().join(process.cwd(),"public",e.url);try{await o().unlink(r),await i.z.media.delete({where:{id:e.id}})}catch(e){console.error(`Failed to delete file: ${r}`,e)}});return await Promise.all(t),await i.z.batch.delete({where:{id:e}}),{success:!0,message:"Batch deleted successfully"}},m=async e=>{let{reference:r,id:t}=e;if(!r)return{success:!1,message:"Reference is required"};let a=await i.z.batch.findFirst({where:{id:t}});if(!a)return{success:!1,message:"Batch not found"};let s=a.reference;return s.slice(7)!==r&&(s=(0,i.k)(r)),await i.z.batch.update({where:{id:t},data:{reference:s}}),{success:!0,message:"Batch updated successfully"}};(0,l.D)([u,m]),(0,s.A)(u,"7fae3cdaf7e4a58385ded3bdbc4784b5095114875b",null),(0,s.A)(m,"7fcbe02165971ead0d61c5c2b179654ffe053245b0",null)},30711:(e,r,t)=>{"use strict";var a=t(99667);t.o(a,"useRouter")&&t.d(r,{useRouter:function(){return a.useRouter}})},33873:e=>{"use strict";e.exports=require("path")},36741:(e,r,t)=>{"use strict";t.d(r,{C5:()=>b,MJ:()=>x,eI:()=>h,lR:()=>f,lV:()=>o,zB:()=>u});var a=t(56877),s=t(9048),i=t(93179),n=t(20617),d=t(79516),c=t(78557);let o=n.Op,l=s.createContext({}),u=({...e})=>(0,a.jsx)(l.Provider,{value:{name:e.name},children:(0,a.jsx)(n.xI,{...e})}),m=()=>{let e=s.useContext(l),r=s.useContext(p),{getFieldState:t}=(0,n.xW)(),a=(0,n.lN)({name:e.name}),i=t(e.name,a);if(!e)throw Error("useFormField should be used within <FormField>");let{id:d}=r;return{id:d,name:e.name,formItemId:`${d}-form-item`,formDescriptionId:`${d}-form-item-description`,formMessageId:`${d}-form-item-message`,...i}},p=s.createContext({});function h({className:e,...r}){let t=s.useId();return(0,a.jsx)(p.Provider,{value:{id:t},children:(0,a.jsx)("div",{"data-slot":"form-item",className:(0,d.cn)("grid gap-2",e),...r})})}function f({className:e,...r}){let{error:t,formItemId:s}=m();return(0,a.jsx)(c.J,{"data-slot":"form-label","data-error":!!t,className:(0,d.cn)("data-[error=true]:text-destructive",e),htmlFor:s,...r})}function x({...e}){let{error:r,formItemId:t,formDescriptionId:s,formMessageId:n}=m();return(0,a.jsx)(i.DX,{"data-slot":"form-control",id:t,"aria-describedby":r?`${s} ${n}`:`${s}`,"aria-invalid":!!r,...e})}function b({className:e,...r}){let{error:t,formMessageId:s}=m(),i=t?String(t?.message??""):r.children;return i?(0,a.jsx)("p",{"data-slot":"form-message",id:s,className:(0,d.cn)("text-destructive text-sm",e),...r,children:i}):null}},41693:(e,r,t)=>{"use strict";t.d(r,{BT:()=>c,Wu:()=>o,ZB:()=>d,Zp:()=>i,aR:()=>n,wL:()=>l});var a=t(56877);t(9048);var s=t(79516);function i({className:e,...r}){return(0,a.jsx)("div",{"data-slot":"card",className:(0,s.cn)("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",e),...r})}function n({className:e,...r}){return(0,a.jsx)("div",{"data-slot":"card-header",className:(0,s.cn)("@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-1.5 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",e),...r})}function d({className:e,...r}){return(0,a.jsx)("div",{"data-slot":"card-title",className:(0,s.cn)("leading-none font-semibold",e),...r})}function c({className:e,...r}){return(0,a.jsx)("div",{"data-slot":"card-description",className:(0,s.cn)("text-muted-foreground text-sm",e),...r})}function o({className:e,...r}){return(0,a.jsx)("div",{"data-slot":"card-content",className:(0,s.cn)("px-6",e),...r})}function l({className:e,...r}){return(0,a.jsx)("div",{"data-slot":"card-footer",className:(0,s.cn)("flex items-center px-6 [.border-t]:pt-6",e),...r})}},55511:e=>{"use strict";e.exports=require("crypto")},56036:(e,r,t)=>{"use strict";t.r(r),t.d(r,{GlobalError:()=>n.a,__next_app__:()=>u,pages:()=>l,routeModule:()=>m,tree:()=>o});var a=t(39553),s=t(74854),i=t(23296),n=t.n(i),d=t(87047),c={};for(let e in d)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(c[e]=()=>d[e]);t.d(r,c);let o={children:["",{children:["admin",{children:["batches",{children:["[id]",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,23365)),"C:\\xampp\\htdocs\\digicon_api\\src\\app\\admin\\batches\\[id]\\page.tsx"]}]},{}]},{}]},{layout:[()=>Promise.resolve().then(t.bind(t,21088)),"C:\\xampp\\htdocs\\digicon_api\\src\\app\\admin\\layout.tsx"],metadata:{icon:[async e=>(await Promise.resolve().then(t.bind(t,84162))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(t.bind(t,71299)),"C:\\xampp\\htdocs\\digicon_api\\src\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(t.t.bind(t,75532,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(t.t.bind(t,15117,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(t.t.bind(t,53610,23)),"next/dist/client/components/unauthorized-error"],metadata:{icon:[async e=>(await Promise.resolve().then(t.bind(t,84162))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]}.children,l=["C:\\xampp\\htdocs\\digicon_api\\src\\app\\admin\\batches\\[id]\\page.tsx"],u={require:t,loadChunk:()=>Promise.resolve()},m=new a.AppPageRouteModule({definition:{kind:s.RouteKind.APP_PAGE,page:"/admin/batches/[id]/page",pathname:"/admin/batches/[id]",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:o}})},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},78557:(e,r,t)=>{"use strict";t.d(r,{J:()=>n});var a=t(56877);t(9048);var s=t(44593),i=t(79516);function n({className:e,...r}){return(0,a.jsx)(s.b,{"data-slot":"label",className:(0,i.cn)("flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50",e),...r})}},78965:(e,r,t)=>{Promise.resolve().then(t.bind(t,19384)),Promise.resolve().then(t.bind(t,78302)),Promise.resolve().then(t.bind(t,45991))},79551:e=>{"use strict";e.exports=require("url")},79748:e=>{"use strict";e.exports=require("fs/promises")},88693:(e,r,t)=>{Promise.resolve().then(t.bind(t,9004)),Promise.resolve().then(t.bind(t,45612)),Promise.resolve().then(t.bind(t,82645))},96330:e=>{"use strict";e.exports=require("@prisma/client")}};var r=require("../../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),a=r.X(0,[659,603,412,687,791,256,677],()=>t(56036));module.exports=a})();